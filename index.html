<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZIMRA Offshore Tax Detection</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<style>
    /* Base Styles */
:root {
    --primary: #2c3e50;
    --secondary: #3498db;
    --accent: #e74c3c;
    --light: #ecf0f1;
    --dark: #2c3e50;
    --success: #27ae60;
    --warning: #f39c12;
    --danger: #e74c3c;
    --gray: #95a5a6;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Roboto', sans-serif;
    background-color: #f5f7fa;
    color: var(--dark);
    line-height: 1.6;
}

.container {
    width: 90%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
}

/* Header Styles */
.header {
    background-color: var(--primary);
    color: white;
    padding: 15px 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    position: sticky;
    top: 0;
    z-index: 100;
}

.header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo img {
    height: 40px;
}

.logo h1 {
    font-size: 1.4rem;
    font-weight: 500;
}

.nav ul {
    display: flex;
    list-style: none;
    gap: 25px;
}

.nav a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    padding: 5px 0;
    position: relative;
    transition: color 0.3s;
}

.nav a:hover {
    color: var(--secondary);
}

.nav a.active {
    color: var(--secondary);
}

.nav a.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--secondary);
    animation: underline 0.3s ease-out;
}

.user-menu {
    display: flex;
    align-items: center;
    gap: 15px;
}

.avatar {
    width: 40px;
    height: 40px;
    background-color: var(--secondary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: transform 0.3s;
}

.avatar:hover {
    transform: scale(1.1);
}

/* Main Content Styles */
.main-content {
    padding: 30px 0;
    min-height: calc(100vh - 120px);
}

.section {
    display: none;
}

.section.active {
    display: block;
    animation: fadeIn 0.5s ease-in;
}

h2 {
    font-size: 2rem;
    margin-bottom: 30px;
    color: var(--primary);
    position: relative;
    padding-bottom: 10px;
}

h2::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 60px;
    height: 3px;
    background-color: var(--secondary);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background-color: white;
    border-radius: 8px;
    padding: 25px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    transition: transform 0.3s, box-shadow 0.3s;
    position: relative;
    overflow: hidden;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px rgba(0,0,0,0.1);
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background-color: var(--secondary);
}

.stat-icon {
    width: 50px;
    height: 50px;
    background-color: rgba(52, 152, 219, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 15px;
    color: var(--secondary);
    font-size: 1.2rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    margin: 10px 0;
    color: var(--primary);
}

.stat-change {
    font-size: 0.9rem;
}

.stat-change.positive {
    color: var(--success);
}

.stat-change.negative {
    color: var(--danger);
}

.stat-change.neutral {
    color: var(--gray);
}

/* Main Grid */
.main-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 20px;
}

.card {
    background-color: white;
    border-radius: 8px;
    padding: 25px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

.chart-card {
    min-height: 400px;
}

.chart-container {
    height: 350px;
    margin-top: 20px;
    position: relative;
}

.alert-card {
    overflow: hidden;
}

.alert-list {
    margin-top: 20px;
}

.alert-item {
    padding: 15px;
    border-left: 4px solid var(--warning);
    margin-bottom: 15px;
    background-color: #fff9e6;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: transform 0.3s;
}

.alert-item:hover {
    transform: translateX(5px);
}

.alert-item.critical {
    border-left-color: var(--danger);
    background-color: #ffebee;
}

.alert-item.resolved {
    border-left-color: var(--success);
    background-color: #e8f5e9;
}

.alert-content h4 {
    font-size: 1rem;
    margin-bottom: 5px;
    color: var(--dark);
}

.alert-content p {
    font-size: 0.85rem;
    color: var(--gray);
}

.alert-badge {
    padding: 3px 8px;
    border-radius: 20px;
    font-size: 0.7rem;
    font-weight: 600;
    color: white;
}

.badge-critical {
    background-color: var(--danger);
}

.badge-warning {
    background-color: var(--warning);
}

/* Case Management Styles */
.case-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.case-card {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    transition: transform 0.3s;
    border-left: 4px solid var(--secondary);
}

.case-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 15px rgba(0,0,0,0.1);
}

.case-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.case-id {
    font-weight: 700;
    color: var(--primary);
}

.case-status {
    padding: 3px 10px;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
}

.status-new {
    background-color: #d4edff;
    color: var(--secondary);
}

.status-investigation {
    background-color: #fff3cd;
    color: #856404;
}

.status-resolved {
    background-color: #d4edda;
    color: #155724;
}

.case-details {
    margin-bottom: 15px;
}

.case-detail {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
    font-size: 0.9rem;
}

.case-label {
    color: var(--gray);
    font-weight: 500;
}

.case-value {
    font-weight: 600;
}

.case-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 15px;
}

.btn {
    padding: 8px 15px;
    border-radius: 4px;
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    border: none;
    transition: all 0.3s;
}

.btn-primary {
    background-color: var(--secondary);
    color: white;
}

.btn-primary:hover {
    background-color: #2980b9;
}

.btn-outline {
    background-color: transparent;
    border: 1px solid var(--secondary);
    color: var(--secondary);
}

.btn-outline:hover {
    background-color: rgba(52, 152, 219, 0.1);
}

/* Analytics Styles */
.analytics-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
}

.analytics-card {
    grid-column: span 1;
}

.analytics-card.wide {
    grid-column: span 2;
}

/* International Cooperation Styles */
.treaty-card {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

.treaty-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.treaty-name {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary);
}

.treaty-status {
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
}

.status-active {
    background-color: #d4edda;
    color: #155724;
}

.status-pending {
    background-color: #fff3cd;
    color: #856404;
}

.treaty-details {
    margin-bottom: 15px;
    font-size: 0.9rem;
}

.treaty-countries {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
}

.country-badge {
    padding: 3px 10px;
    background-color: #f8f9fa;
    border-radius: 20px;
    font-size: 0.8rem;
    color: var(--dark);
}

/* Best Practices Styles */
.practice-card {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

.practice-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.practice-icon {
    width: 40px;
    height: 40px;
    background-color: rgba(52, 152, 219, 0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    color: var(--secondary);
}

.practice-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary);
}

.practice-content {
    font-size: 0.95rem;
    line-height: 1.6;
}

.practice-stats {
    display: flex;
    gap: 15px;
    margin-top: 15px;
    font-size: 0.85rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 5px;
    color: var(--gray);
}

/* Footer Styles */
.footer {
    background-color: var(--primary);
    color: white;
    padding: 20px 0;
    text-align: center;
}

.footer .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.footer-links {
    display: flex;
    gap: 20px;
}

.footer-links a {
    color: white;
    text-decoration: none;
    transition: color 0.3s;
}

.footer-links a:hover {
    color: var(--secondary);
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slide-up {
    from { 
        opacity: 0;
        transform: translateY(20px);
    }
    to { 
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes underline {
    from { width: 0; }
    to { width: 100%; }
}

.fade-in {
    animation: fadeIn 0.6s ease-in forwards;
}

.slide-up {
    animation: slide-up 0.5s ease-out forwards;
}

/* Delays for staggered animations */
.stat-card:nth-child(1) { animation-delay: 0.1s; }
.stat-card:nth-child(2) { animation-delay: 0.2s; }
.stat-card:nth-child(3) { animation-delay: 0.3s; }
.stat-card:nth-child(4) { animation-delay: 0.4s; }

/* Simulation Styles */
.simulation-controls {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 20px;
    margin-bottom: 30px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-family: inherit;
}

.scenario-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 20px;
}

.scenario-card {
    padding: 15px;
    border: 1px solid #eee;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}

.scenario-card:hover {
    border-color: var(--secondary);
    background-color: rgba(52, 152, 219, 0.05);
}

.scenario-card.selected {
    border-color: var(--secondary);
    background-color: rgba(52, 152, 219, 0.1);
}

.scenario-meta {
    display: flex;
    justify-content: space-between;
    margin-top: 10px;
    font-size: 0.85rem;
}

.difficulty {
    padding: 2px 8px;
    border-radius: 10px;
    font-weight: 500;
}

.difficulty.easy {
    background-color: rgba(46, 204, 113, 0.2);
    color: #27ae60;
}

.difficulty.medium {
    background-color: rgba(241, 196, 15, 0.2);
    color: #f39c12;
}

.difficulty.hard {
    background-color: rgba(231, 76, 60, 0.2);
    color: #e74c3c;
}

.simulation-results {
    display: none; /* Initially hidden */
}

.transaction-list {
    max-height: 400px;
    overflow-y: auto;
}

.transaction-item {
    padding: 12px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
}

.transaction-item:last-child {
    border-bottom: none;
}

.transaction-amount {
    font-weight: 600;
}

.transaction-detected {
    color: var(--success);
    font-weight: 500;
}

.transaction-undetected {
    color: var(--danger);
    font-weight: 500;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .simulation-controls {
        grid-template-columns: 1fr;
    }
    
    .scenario-options {
        grid-template-columns: 1fr;
    }
}

/* Responsive Styles */
@media (max-width: 1024px) {
    .main-grid, .analytics-grid {
        grid-template-columns: 1fr;
    }
    
    .header .container {
        flex-direction: column;
        gap: 15px;
    }
    
    .nav ul {
        gap: 15px;
    }
    
    .analytics-card.wide {
        grid-column: span 1;
    }
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr 1fr;
    }
    
    .nav ul {
        flex-wrap: wrap;
        justify-content: center;
    }
}

@media (max-width: 480px) {
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .footer .container {
        flex-direction: column;
        gap: 10px;
    }
}
</style>
<body>
    <header class="header">
        <div class="container">
            <div class="logo">
                <img src="/image.png" alt="ZIMRA Logo">
                <h1>Offshore Tax Detection System</h1>
            </div>
            <nav class="nav">
                <ul>
                    <li><a href="#dashboard" class="active">Dashboard</a></li>
                    <li><a href="#cases">Case Management</a></li>
                    <li><a href="#analytics">Analytics</a></li>
                    <li><a href="#international">International</a></li>
                    <li><a href="#best-practices">Best Practices</a></li>
                    <li><a href="#simulation">Simulation</a></li>
                </ul>
            </nav>
            <div class="user-menu">
                <span>Welcome, Investigator</span>
                <div class="avatar">
                    <i class="fas fa-user-shield"></i>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <section id="dashboard" class="section active">
            <div class="container">
                <h2>Detection Dashboard</h2>
                <div class="stats-grid">
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-search-dollar"></i>
                        </div>
                        <h3>Potential Cases</h3>
                        <p class="stat-value" id="potential-cases">0</p>
                        <p class="stat-change positive">+12% from last month</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-hand-holding-usd"></i>
                        </div>
                        <h3>Amount Recovered</h3>
                        <p class="stat-value" id="amount-recovered">$0</p>
                        <p class="stat-change positive">+$2.4M this quarter</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-globe-africa"></i>
                        </div>
                        <h3>Int'l Requests</h3>
                        <p class="stat-value" id="intl-requests">0</p>
                        <p class="stat-change neutral">No change</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>Detection Rate</h3>
                        <p class="stat-value" id="detection-rate">0%</p>
                        <p class="stat-change positive">+8% YoY</p>
                    </div>
                </div>
                
                <div class="main-grid">
                    <div class="card chart-card slide-up">
                        <h3>Monthly Detection Trends</h3>
                        <div class="chart-container">
                            <canvas id="trends-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card alert-card slide-up">
                        <h3>Priority Alerts</h3>
                        <div class="alert-list" id="alert-list">
                            <!-- Alerts will be populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="cases" class="section">
            <div class="container">
                <h2>Case Management</h2>
                <div class="stats-grid">
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-folder-open"></i>
                        </div>
                        <h3>Active Cases</h3>
                        <p class="stat-value" id="active-cases">42</p>
                        <p class="stat-change positive">+5 from last week</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-hourglass-half"></i>
                        </div>
                        <h3>Pending Review</h3>
                        <p class="stat-value" id="pending-cases">18</p>
                        <p class="stat-change negative">-3 from last week</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>Resolved Cases</h3>
                        <p class="stat-value" id="resolved-cases">27</p>
                        <p class="stat-change positive">+4 this month</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-gavel"></i>
                        </div>
                        <h3>Legal Actions</h3>
                        <p class="stat-value" id="legal-actions">9</p>
                        <p class="stat-change neutral">No change</p>
                    </div>
                </div>
                
                <div class="case-grid" id="case-grid">
                    <!-- Case cards will be populated by JS -->
                </div>
            </div>
        </section>

        <section id="analytics" class="section">
            <div class="container">
                <h2>Analytics & Detection Strategies</h2>
                <div class="analytics-grid">
                    <div class="card analytics-card">
                        <h3>Detection Methods Effectiveness</h3>
                        <div class="chart-container">
                            <canvas id="methods-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card analytics-card">
                        <h3>Offshore Jurisdictions</h3>
                        <div class="chart-container">
                            <canvas id="jurisdictions-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card analytics-card wide">
                        <h3>Technology Adoption Impact</h3>
                        <div class="chart-container">
                            <canvas id="technology-chart"></canvas>
                        </div>
                        <div class="practice-content">
                            <p>Advanced technologies like AI and blockchain have shown a <strong>42% higher effectiveness</strong> in detecting offshore tax evasion compared to traditional methods. Authorities using predictive analytics and AI-driven data monitoring had a <strong>30% higher success rate</strong> in detecting hidden offshore accounts.</p>
                        </div>
                    </div>
                    
                    <div class="card analytics-card">
                        <h3>International Cooperation Impact</h3>
                        <div class="chart-container">
                            <canvas id="cooperation-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card analytics-card">
                        <h3>Personnel Training Impact</h3>
                        <div class="chart-container">
                            <canvas id="training-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="international" class="section">
            <div class="container">
                <h2>International Cooperation</h2>
                <div class="stats-grid">
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-handshake"></i>
                        </div>
                        <h3>Active Treaties</h3>
                        <p class="stat-value" id="active-treaties">14</p>
                        <p class="stat-change positive">+2 this year</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3>Information Requests</h3>
                        <p class="stat-value" id="info-requests">87</p>
                        <p class="stat-change positive">+15% YoY</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-globe-europe"></i>
                        </div>
                        <h3>Partner Countries</h3>
                        <p class="stat-value" id="partner-countries">36</p>
                        <p class="stat-change positive">+4 this year</p>
                    </div>
                    
                    <div class="stat-card fade-in">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Recovered via Treaties</h3>
                        <p class="stat-value" id="treaty-recovered">$8.2M</p>
                        <p class="stat-change positive">+$1.5M this year</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3>Key International Agreements</h3>
                    <div id="treaties-list">
                        <!-- Treaty cards will be populated by JS -->
                    </div>
                </div>
                
                <div class="main-grid">
                    <div class="card chart-card">
                        <h3>Information Exchange Effectiveness</h3>
                        <div class="chart-container">
                            <canvas id="exchange-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Recent Cooperation Activities</h3>
                        <div class="alert-list" id="cooperation-activities">
                            <!-- Activities will be populated by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="best-practices" class="section">
            <div class="container">
                <h2>Best Practices in Offshore Tax Detection</h2>
                
                <div class="card">
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="practice-title">Advanced Data Analytics & AI</div>
                        </div>
                        <div class="practice-content">
                            <p>Implementation of AI-driven algorithms and machine learning techniques to analyze large datasets for suspicious patterns. This approach has shown a <strong>42% increase</strong> in detection effectiveness compared to traditional methods.</p>
                            <div class="practice-stats">
                                <div class="stat-item">
                                    <i class="fas fa-chart-line"></i>
                                    <span>+30% detection rate</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-clock"></i>
                                    <span>50% faster analysis</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="practice-title">Automatic Information Exchange</div>
                        </div>
                        <div class="practice-content">
                            <p>Participation in the OECD's Common Reporting Standard (CRS) has improved offshore tax evasion tracking by <strong>35%</strong>. Countries with bilateral agreements recovered <strong>20% more</strong> lost tax revenue than those without agreements.</p>
                            <div class="practice-stats">
                                <div class="stat-item">
                                    <i class="fas fa-globe"></i>
                                    <span>100+ countries participating</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <span>$12.7M recovered</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="practice-title">Specialized Investigation Units</div>
                        </div>
                        <div class="practice-content">
                            <p>Establishment of dedicated offshore tax evasion units with specialized training in forensic accounting and international tax law. These units have demonstrated <strong>25% higher</strong> case resolution rates compared to general audit teams.</p>
                            <div class="practice-stats">
                                <div class="stat-item">
                                    <i class="fas fa-user-graduate"></i>
                                    <span>150+ trained specialists</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-gavel"></i>
                                    <span>45% conviction rate</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">
                                <i class="fas fa-project-diagram"></i>
                            </div>
                            <div class="practice-title">Cross-Border Joint Audits</div>
                        </div>
                        <div class="practice-content">
                            <p>Collaborative audits with foreign tax authorities increase conviction rates for tax evaders by <strong>18%</strong>. The African Tax Administration Forum (ATAF) has been particularly effective in facilitating regional cooperation.</p>
                            <div class="practice-stats">
                                <div class="stat-item">
                                    <i class="fas fa-handshake"></i>
                                    <span>12 joint audits completed</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-money-bill-wave"></i>
                                    <span>$3.2M additional recovery</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="practice-card">
                        <div class="practice-header">
                            <div class="practice-icon">
                                <i class="fas fa-bullhorn"></i>
                            </div>
                            <div class="practice-title">Public Awareness Campaigns</div>
                        </div>
                        <div class="practice-content">
                            <p>Initiatives that educate taxpayers about the consequences of tax evasion and promote a culture of compliance can lead to measurable improvements in detection rates and overall tax revenues.</p>
                            <div class="practice-stats">
                                <div class="stat-item">
                                    <i class="fas fa-chart-pie"></i>
                                    <span>15% increase in disclosures</span>
                                </div>
                                <div class="stat-item">
                                    <i class="fas fa-users"></i>
                                    <span>2000+ taxpayers educated</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="simulation" class="section">
            <div class="container">
                <h2>Tax Evasion Simulation Lab</h2>
                
                <div class="simulation-controls">
                    <!-- Taxpayer Creation -->
                    <div class="card">
                        <h3>Create Taxpayer Profile</h3>
                        <div class="form-group">
                            <label for="taxpayer-name">Name</label>
                            <input type="text" id="taxpayer-name" class="form-control" placeholder="John Doe">
                        </div>
                        <div class="form-group">
                            <label for="taxpayer-tin">Tax ID</label>
                            <input type="text" id="taxpayer-tin" class="form-control" placeholder="123-456-789">
                        </div>
                        <div class="form-group">
                            <label for="taxpayer-income">Income Level</label>
                            <select id="taxpayer-income" class="form-control">
                                <option value="low">Low ($10k-$50k)</option>
                                <option value="medium" selected>Medium ($50k-$200k)</option>
                                <option value="high">High ($200k+)</option>
                            </select>
                        </div>
                        <button id="create-taxpayer" class="btn btn-primary">Create Profile</button>
                    </div>
                    
                    <!-- Scenario Selection -->
                    <div class="card">
                        <h3>Select Evasion Scenario</h3>
                        <div class="scenario-options">
                            <div class="scenario-card" data-scenario="offshore">
                                <h4>Offshore Accounts</h4>
                                <p>Hide assets in foreign bank accounts</p>
                                <div class="scenario-meta">
                                    <span class="difficulty medium">Medium</span>
                                    <span class="detection">65% detection</span>
                                </div>
                            </div>
                            <div class="scenario-card" data-scenario="underreport">
                                <h4>Underreport Income</h4>
                                <p>Declare less income than earned</p>
                                <div class="scenario-meta">
                                    <span class="difficulty easy">Easy</span>
                                    <span class="detection">45% detection</span>
                                </div>
                            </div>
                            <div class="scenario-card" data-scenario="expenses">
                                <h4>Fake Expenses</h4>
                                <p>Inflate business expenses</p>
                                <div class="scenario-meta">
                                    <span class="difficulty medium">Medium</span>
                                    <span class="detection">55% detection</span>
                                </div>
                            </div>
                            <div class="scenario-card" data-scenario="crypto">
                                <h4>Crypto Concealment</h4>
                                <p>Use cryptocurrency to hide assets</p>
                                <div class="scenario-meta">
                                    <span class="difficulty hard">Hard</span>
                                    <span class="detection">35% detection</span>
                                </div>
                            </div>
                        </div>
                        <button id="run-simulation" class="btn btn-primary" disabled>Run Simulation</button>
                    </div>
                </div>
                
                <!-- Simulation Results -->
                <div class="simulation-results">
                    <h3>Simulation Results</h3>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-secret"></i>
                        </div>
                        <h3>Evasion Attempts</h3>
                        <p class="stat-value" id="attempts-count">0</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>Detected</h3>
                        <p class="stat-value" id="detected-count">0</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-percentage"></i>
                        </div>
                        <h3>Detection Rate</h3>
                        <p class="stat-value" id="detection-rate">0%</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Amount Evaded</h3>
                        <p class="stat-value" id="amount-evaded">$0</p>
                    </div>
                    
                    <div class="card">
                        <h3>Detection Timeline</h3>
                        <div class="chart-container">
                            <canvas id="simulation-chart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3>Transaction Details</h3>
                        <div class="transaction-list" id="transaction-list">
                            <p>No simulation data yet. Run a simulation to see results.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>ZIMRA Offshore Tax Evasion Detection System &copy; 2023</p>
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Use</a>
                <a href="#">Help Center</a>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
       // DOM Elements
const sections = document.querySelectorAll('.section');
const navLinks = document.querySelectorAll('.nav a');
const statValues = {
    'potential-cases': 87,
    'amount-recovered': '$12.7M',
    'intl-requests': 23,
    'detection-rate': '78%',
    'active-cases': 42,
    'pending-cases': 18,
    'resolved-cases': 27,
    'legal-actions': 9,
    'active-treaties': 14,
    'info-requests': 87,
    'partner-countries': 36,
    'treaty-recovered': '$8.2M'
};

// Sample alerts data
const alerts = [
    {
        title: "High-value offshore transfer detected",
        description: "Taxpayer ID 45782 transferred $1.2M to Mauritius",
        status: "critical",
        date: "Today, 09:45"
    },
    {
        title: "Potential undisclosed foreign account",
        description: "Taxpayer ID 32945 has possible undisclosed Swiss account",
        status: "warning",
        date: "Yesterday, 14:30"
    },
    {
        title: "Foreign property ownership mismatch",
        description: "Taxpayer ID 78231 declared no foreign properties but found UK residence",
        status: "warning",
        date: "2 days ago"
    },
    {
        title: "Case resolved - funds recovered",
        description: "$450,000 recovered from taxpayer ID 12938",
        status: "resolved",
        date: "1 week ago"
    }
];

// Sample cases data
const cases = [
    {
        id: "EV-2023-0457",
        status: "investigation",
        taxpayer: "John B. Enterprises",
        amount: "$1,450,000",
        jurisdiction: "Mauritius",
        date: "2023-05-15",
        assigned: "Investigator T. Chuma"
    },
    {
        id: "EV-2023-0382",
        status: "new",
        taxpayer: "Smith Family Trust",
        amount: "$780,000",
        jurisdiction: "Cayman Islands",
        date: "2023-06-02",
        assigned: "Pending assignment"
    },
    {
        id: "EV-2023-0291",
        status: "investigation",
        taxpayer: "XYZ Holdings Ltd",
        amount: "$2,100,000",
        jurisdiction: "Switzerland",
        date: "2023-04-18",
        assigned: "Investigator L. Moyo"
    },
    {
        id: "EV-2023-0176",
        status: "resolved",
        taxpayer: "ABC Corporation",
        amount: "$450,000",
        jurisdiction: "Singapore",
        date: "2023-03-22",
        assigned: "Investigator S. Ndlovu"
    },
    {
        id: "EV-2023-0523",
        status: "new",
        taxpayer: "Individual - ID 78294",
        amount: "$320,000",
        jurisdiction: "Panama",
        date: "2023-06-10",
        assigned: "Pending assignment"
    },
    {
        id: "EV-2023-0412",
        status: "investigation",
        taxpayer: "Global Investments Inc",
        amount: "$1,870,000",
        jurisdiction: "British Virgin Islands",
        date: "2023-05-28",
        assigned: "Investigator T. Chuma"
    }
];

// Sample treaties data
const treaties = [
    {
        name: "Common Reporting Standard (CRS)",
        status: "active",
        description: "Automatic exchange of financial account information between tax authorities. Implemented since 2017 with 100+ participating jurisdictions.",
        countries: ["UK", "South Africa", "Mauritius", "Germany", "France", "Australia"],
        effectiveness: "High",
        recovered: "$3.2M"
    },
    {
        name: "African Tax Administration Forum (ATAF) Agreement",
        status: "active",
        description: "Regional cooperation framework for tax administration in Africa, including joint audits and capacity building.",
        countries: ["Zimbabwe", "South Africa", "Namibia", "Botswana", "Zambia", "Kenya"],
        effectiveness: "Medium",
        recovered: "$1.5M"
    },
    {
        name: "UK-Zimbabwe Double Taxation Agreement",
        status: "active",
        description: "Bilateral agreement for prevention of fiscal evasion with respect to taxes on income.",
        countries: ["Zimbabwe", "UK"],
        effectiveness: "High",
        recovered: "$2.1M"
    },
    {
        name: "OECD BEPS Inclusive Framework",
        status: "pending",
        description: "Comprehensive framework to tackle base erosion and profit shifting by multinational enterprises.",
        countries: ["OECD Members", "Zimbabwe (pending)"],
        effectiveness: "N/A",
        recovered: "N/A"
    }
];

// Sample cooperation activities
const cooperationActivities = [
    {
        title: "Joint audit with South African Revenue Service",
        description: "Collaborative investigation into multinational corporation with operations in both countries",
        status: "completed",
        date: "2023-05-20"
    },
    {
        title: "Information request to Swiss authorities",
        description: "Submitted request for banking information on 3 high-net-worth individuals",
        status: "pending",
        date: "2023-06-05"
    },
    {
        title: "ATAF training workshop attended",
        description: "2 officers participated in regional training on offshore tax evasion detection",
        status: "completed",
        date: "2023-04-15"
    },
    {
        title: "CRS data received from Mauritius",
        description: "Annual automatic exchange of financial account information completed",
        status: "completed",
        date: "2023-06-01"
    }
];

function displayResults(totalEvaded, totalDetected) {
    // Update dashboard stats
    document.getElementById('attempts-count').textContent = simulationState.transactions.length;
    document.getElementById('detected-count').textContent = totalDetected;
    document.getElementById('detection-rate').textContent = `${Math.round((totalDetected / totalEvaded) * 100)}%`;
    document.getElementById('amount-evaded').textContent = `$${totalEvaded.toLocaleString(undefined, {maximumFractionDigits: 2})}`;
    
    // Show results section
    document.querySelector('.simulation-results').style.display = 'block';
}

// Initialize the dashboard
document.addEventListener('DOMContentLoaded', function() {
    // Update stat values with animation
    for (const [id, value] of Object.entries(statValues)) {
        animateValue(id, 0, value, 1000);
    }

    // Render alerts
    renderAlerts();

    // Render cases
    renderCases();

    // Render treaties
    renderTreaties();

    // Render cooperation activities
    renderCooperationActivities();

    // Initialize charts
    initTrendsChart();
    initMethodsChart();
    initJurisdictionsChart();
    initTechnologyChart();
    initCooperationChart();
    initTrainingChart();
    initExchangeChart();

    // Set up navigation
    setupNavigation();
});

// Animate stat counter (fixed for numbers, no animation for $/percent)
function animateValue(id, start, end, duration) {
    const element = document.getElementById(id);
    if (!element) return;

    // Only animate if end is a plain number
    if (typeof end === 'number') {
        const range = end - start;
        let current = start;
        const increment = end > start ? 1 : -1;
        const stepTime = Math.abs(Math.floor(duration / range));
        const timer = setInterval(function () {
            current += increment;
            element.textContent = current;
            if (current === end) {
                clearInterval(timer);
            }
        }, stepTime);
    } else {
        // Not a number: just set value
        element.textContent = end;
    }
}

// Render alerts list
function renderAlerts() {
    const alertList = document.getElementById('alert-list');
    if (!alertList) return;

    alertList.innerHTML = alerts.map(alert => `
        <div class="alert-item ${alert.status === 'critical' ? 'critical' : ''} ${alert.status === 'resolved' ? 'resolved' : ''}">
            <div class="alert-content">
                <h4>${alert.title}</h4>
                <p>${alert.description} • ${alert.date}</p>
            </div>
            <span class="alert-badge ${
                alert.status === 'resolved'
                    ? 'badge-warning'
                    : alert.status === 'critical'
                        ? 'badge-critical'
                        : 'badge-warning'
            }">
                ${
                    alert.status === 'resolved'
                        ? 'Resolved'
                        : alert.status === 'critical'
                            ? 'Critical'
                            : 'Warning'
                }
            </span>
        </div>
    `).join('');
}

// Render cases grid
function renderCases() {
    const caseGrid = document.getElementById('case-grid');
    if (!caseGrid) return;

    caseGrid.innerHTML = cases.map(caseItem => `
        <div class="case-card">
            <div class="case-header">
                <span class="case-id">${caseItem.id}</span>
                <span class="case-status status-${caseItem.status}">
                    ${caseItem.status.charAt(0).toUpperCase() + caseItem.status.slice(1)}
                </span>
            </div>
            <div class="case-details">
                <div class="case-detail">
                    <span class="case-label">Taxpayer:</span>
                    <span class="case-value">${caseItem.taxpayer}</span>
                </div>
                <div class="case-detail">
                    <span class="case-label">Amount:</span>
                    <span class="case-value">${caseItem.amount}</span>
                </div>
                <div class="case-detail">
                    <span class="case-label">Jurisdiction:</span>
                    <span class="case-value">${caseItem.jurisdiction}</span>
                </div>
                <div class="case-detail">
                    <span class="case-label">Date Opened:</span>
                    <span class="case-value">${caseItem.date}</span>
                </div>
                <div class="case-detail">
                    <span class="case-label">Assigned To:</span>
                    <span class="case-value">${caseItem.assigned}</span>
                </div>
            </div>
            <div class="case-actions">
                <button class="btn btn-outline">View Details</button>
                <button class="btn btn-primary">Take Action</button>
            </div>
        </div>
    `).join('');
}

// Render treaties list
function renderTreaties() {
    const treatiesList = document.getElementById('treaties-list');
    if (!treatiesList) return;

    treatiesList.innerHTML = treaties.map(treaty => `
        <div class="treaty-card">
            <div class="treaty-header">
                <div class="treaty-name">${treaty.name}</div>
                <div class="treaty-status status-${treaty.status}">
                    ${treaty.status.charAt(0).toUpperCase() + treaty.status.slice(1)}
                </div>
            </div>
            <div class="treaty-details">
                <p>${treaty.description}</p>
                <p><strong>Effectiveness:</strong> ${treaty.effectiveness}</p>
                ${treaty.status === 'active' ? `<p><strong>Amount Recovered:</strong> ${treaty.recovered}</p>` : ''}
            </div>
            <div class="treaty-countries">
                ${treaty.countries.map(country => `
                    <span class="country-badge">${country}</span>
                `).join('')}
            </div>
        </div>
    `).join('');
}

// Render cooperation activities
function renderCooperationActivities() {
    const activitiesList = document.getElementById('cooperation-activities');
    if (!activitiesList) return;

    activitiesList.innerHTML = cooperationActivities.map(activity => `
        <div class="alert-item ${activity.status === 'completed' ? 'resolved' : ''}">
            <div class="alert-content">
                <h4>${activity.title}</h4>
                <p>${activity.description} • ${activity.date}</p>
            </div>
            <span class="alert-badge ${activity.status === 'completed' ? 'badge-warning' : 'badge-critical'}">
                ${activity.status === 'completed' ? 'Completed' : 'Pending'}
            </span>
        </div>
    `).join('');
}

// Initialize trends chart
function initTrendsChart() {
    const ctx = document.getElementById('trends-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            datasets: [{
                label: 'Cases Detected',
                data: [12, 19, 15, 27, 24, 18, 22, 31, 28, 35, 42, 39],
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                tension: 0.3,
                fill: true
            }, {
                label: 'Amount Recovered ($M)',
                data: [0.8, 1.2, 0.9, 1.5, 1.8, 1.2, 1.6, 2.1, 2.4, 2.9, 3.2, 2.7],
                borderColor: '#2ecc71',
                backgroundColor: 'rgba(46, 204, 113, 0.1)',
                tension: 0.3,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// Initialize methods chart
function initMethodsChart() {
    const ctx = document.getElementById('methods-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [
                "Data Analytics",
                "Int'l Info Exchange",
                "Whistleblower Tips",
                "Random Audits",
                "Media Reports"
            ],
            datasets: [{
                label: 'Detection Effectiveness',
                data: [42, 37, 28, 15, 12],
                backgroundColor: [
                    'rgba(52, 152, 219, 0.7)',
                    'rgba(155, 89, 182, 0.7)',
                    'rgba(26, 188, 156, 0.7)',
                    'rgba(241, 196, 15, 0.7)',
                    'rgba(231, 76, 60, 0.7)'
                ],
                borderColor: [
                    'rgba(52, 152, 219, 1)',
                    'rgba(155, 89, 182, 1)',
                    'rgba(26, 188, 156, 1)',
                    'rgba(241, 196, 15, 1)',
                    'rgba(231, 76, 60, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'Effectiveness by Detection Method (%)'
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// Initialize jurisdictions chart
function initJurisdictionsChart() {
    const ctx = document.getElementById('jurisdictions-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: [
                'Mauritius',
                'Cayman Islands',
                'Switzerland',
                'Singapore',
                'Panama',
                'BVI',
                'Others'
            ],
            datasets: [{
                data: [28, 22, 18, 12, 10, 6, 4],
                backgroundColor: [
                    'rgba(52, 152, 219, 0.7)',
                    'rgba(155, 89, 182, 0.7)',
                    'rgba(26, 188, 156, 0.7)',
                    'rgba(241, 196, 15, 0.7)',
                    'rgba(231, 76, 60, 0.7)',
                    'rgba(46, 204, 113, 0.7)',
                    'rgba(149, 165, 166, 0.7)'
                ],
                borderColor: [
                    'rgba(52, 152, 219, 1)',
                    'rgba(155, 89, 182, 1)',
                    'rgba(26, 188, 156, 1)',
                    'rgba(241, 196, 15, 1)',
                    'rgba(231, 76, 60, 1)',
                    'rgba(46, 204, 113, 1)',
                    'rgba(149, 165, 166, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'right',
                },
                title: {
                    display: true,
                    text: 'Offshore Jurisdictions (%)'
                }
            }
        }
    });
}

// Initialize technology chart
function initTechnologyChart() {
    const ctx = document.getElementById('technology-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
            datasets: [{
                label: 'With Advanced Tech',
                data: [15, 22, 28, 35, 42, 48],
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                tension: 0.3,
                fill: true
            }, {
                label: 'Without Advanced Tech',
                data: [12, 14, 16, 18, 20, 22],
                borderColor: '#e74c3c',
                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                tension: 0.3,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                },
                title: {
                    display: true,
                    text: 'Detection Effectiveness: Technology Impact (%)'
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// Initialize cooperation chart
function initCooperationChart() {
    const ctx = document.getElementById('cooperation-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [
                'With CRS',
                'With Bilateral Treaties',
                'Regional Cooperation',
                'No Formal Cooperation'
            ],
            datasets: [{
                label: 'Detection Effectiveness',
                data: [35, 20, 18, 10],
                backgroundColor: [
                    'rgba(52, 152, 219, 0.7)',
                    'rgba(155, 89, 182, 0.7)',
                    'rgba(26, 188, 156, 0.7)',
                    'rgba(241, 196, 15, 0.7)'
                ],
                borderColor: [
                    'rgba(52, 152, 219, 1)',
                    'rgba(155, 89, 182, 1)',
                    'rgba(26, 188, 156, 1)',
                    'rgba(241, 196, 15, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                title: {
                    display: true,
                    text: 'International Cooperation Impact (%)'
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// Initialize training chart
function initTrainingChart() {
    const ctx = document.getElementById('training-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: [
                'Forensic Accounting',
                "Int'l Tax Law",
                'Data Analysis',
                'Investigation',
                'Legal Procedures',
                'Tech Tools'
            ],
            datasets: [{
                label: 'Trained Personnel',
                data: [85, 75, 80, 78, 70, 65],
                backgroundColor: 'rgba(52, 152, 219, 0.2)',
                borderColor: 'rgba(52, 152, 219, 1)',
                pointBackgroundColor: 'rgba(52, 152, 219, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(52, 152, 219, 1)'
            }, {
                label: 'Untrained Personnel',
                data: [40, 35, 45, 38, 42, 30],
                backgroundColor: 'rgba(231, 76, 60, 0.2)',
                borderColor: 'rgba(231, 76, 60, 1)',
                pointBackgroundColor: 'rgba(231, 76, 60, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(231, 76, 60, 1)'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Personnel Training Impact (Effectiveness Scores)'
                }
            },
            scales: {
                r: {
                    angleLines: {
                        display: true
                    },
                    suggestedMin: 0,
                    suggestedMax: 100
                }
            }
        }
    });
}

// Initialize exchange chart
function initExchangeChart() {
    const ctx = document.getElementById('exchange-chart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
            datasets: [{
                label: 'Information Requests',
                data: [12, 18, 25, 34, 42, 50],
                backgroundColor: 'rgba(52, 152, 219, 0.7)',
                borderColor: 'rgba(52, 152, 219, 1)',
                borderWidth: 1
            }, {
                label: 'Successful Responses',
                data: [8, 14, 20, 28, 36, 42],
                backgroundColor: 'rgba(46, 204, 113, 0.7)',
                borderColor: 'rgba(46, 204, 113, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                title: {
                    display: true,
                    text: 'Information Exchange Effectiveness'
                }
            },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
}

// Simulation Module
document.addEventListener('DOMContentLoaded', function() {
    // Simulation state
    const simulationState = {
        currentTaxpayer: null,
        selectedScenario: null,
        transactions: [],
        chart: null
    };
    
    // Initialize UI
    initUI();
    
    // Set up event listeners
    document.getElementById('create-taxpayer').addEventListener('click', createTaxpayer);
    document.querySelectorAll('.scenario-card').forEach(card => {
        card.addEventListener('click', selectScenario);
    });
    document.getElementById('run-simulation').addEventListener('click', runSimulation);
});

function initUI() {
    // Hide results initially
    document.querySelector('.simulation-results').style.display = 'none';
    // Disable run simulation button initially
    document.getElementById('run-simulation').disabled = true;
}

function createTaxpayer() {
    const name = document.getElementById('taxpayer-name').value.trim();
    const tin = document.getElementById('taxpayer-tin').value.trim();
    const income = document.getElementById('taxpayer-income').value;
    
    if (!name || !tin) {
        alert('Please enter both name and tax ID');
        return;
    }
    
    simulationState.currentTaxpayer = {
        name,
        tin,
        income
    };
    
    // Enable scenario selection
    document.getElementById('run-simulation').disabled = false;
    
    alert(`Taxpayer profile created for ${name} (${tin})`);
}

function selectScenario(e) {
    // Remove selection from all cards
    document.querySelectorAll('.scenario-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Add to clicked card
    const card = e.currentTarget;
    card.classList.add('selected');
    
    // Store selected scenario
    simulationState.selectedScenario = card.getAttribute('data-scenario');
}

function runSimulation() {
    if (!simulationState.currentTaxpayer) {
        alert('Please create a taxpayer profile first');
        return;
    }
    
    if (!simulationState.selectedScenario) {
        alert('Please select an evasion scenario');
        return;
    }
    
    // Clear previous transactions
    simulationState.transactions = [];
    
    // Generate transactions based on scenario
    const numTransactions = Math.floor(Math.random() * 10) + 5; // 5-15 transactions
    const baseAmount = getBaseAmount(simulationState.currentTaxpayer.income);
    let totalEvaded = 0;
    let totalDetected = 0;
    
    for (let i = 0; i < numTransactions; i++) {
        // Randomize amount (±50% of base amount)
        const amount = baseAmount * (0.5 + Math.random());
        totalEvaded += amount;
        
        // Randomize date within last 12 months
        const transactionDate = new Date();
        transactionDate.setMonth(transactionDate.getMonth() - Math.floor(Math.random() * 12));
        
        // Determine if detected based on scenario probability
        const isDetected = Math.random() < getDetectionProbability(simulationState.selectedScenario);
        const detectionMethod = isDetected ? getDetectionMethod(simulationState.selectedScenario) : null;
        
        if (isDetected) {
            totalDetected += amount;
            
            // Add to main system alerts
            addToMainAlerts({
                amount,
                date: transactionDate,
                method: detectionMethod
            });
        }
        
        simulationState.transactions.push({
            id: Date.now() + i,
            amount: parseFloat(amount.toFixed(2)),
            date: transactionDate,
            detected: isDetected,
            detectionDate: isDetected ? 
                new Date(transactionDate.getTime() + Math.random() * 30 * 24 * 60 * 60 * 1000) : null,
            detectionMethod: detectionMethod
        });
    }
    
    // Update UI with results
    displayResults(totalEvaded, totalDetected);
    
    // Show results section
    document.querySelector('.simulation-results').style.display = 'block';
}

function getBaseAmount(incomeLevel) {
    switch(incomeLevel) {
        case 'low': return 5000;
        case 'medium': return 15000;
        case 'high': return 30000;
        default: return 10000;
    }
}

function getDetectionProbability(scenario) {
    const probabilities = {
        offshore: 0.65,
        underreport: 0.45,
        expenses: 0.55,
        crypto: 0.35
    };
    return probabilities[scenario] || 0.5;
}

function getDetectionMethod(scenario) {
    const methods = {
        offshore: ['CRS Data Match', 'Bank Leak Analysis', 'Whistleblower Tip'],
        underreport: ['Income Discrepancy', 'Third-Party Reporting', 'Audit Findings'],
        expenses: ['Expense Pattern Analysis', 'Supplier Verification', 'Industry Benchmarking'],
        crypto: ['Blockchain Analysis', 'Exchange Reporting', 'Wallet Identification']
    };
    
    const availableMethods = methods[scenario] || ['Data Analysis', 'Automated Alert', 'Manual Review'];
    return availableMethods[Math.floor(Math.random() * availableMethods.length)];
}

function addToMainAlerts(transaction) {
    // In a real app, this would add to your main alert system
    const scenarioName = {
        offshore: 'Offshore Account Concealment',
        underreport: 'Underreported Income',
        expenses: 'Fictitious Expenses',
        crypto: 'Cryptocurrency Concealment'
    }[simulationState.selectedScenario];
    
    const newAlert = {
        title: `Detected ${scenarioName}`,
        description: `Taxpayer ${simulationState.currentTaxpayer.name} (${simulationState.currentTaxpayer.tin}) evaded $${transaction.amount.toLocaleString()}`,
        status: "warning",
        date: formatDate(transaction.date),
        amount: transaction.amount,
        method: transaction.method
    };
    
    // Add to your existing alerts array
    // Assuming you have a global alerts array and renderAlerts() function
    if (typeof alerts !== 'undefined') {
        alerts.push(newAlert);
        
        // Refresh alerts display if on dashboard
        if (document.querySelector('#dashboard').classList.contains('active') && typeof renderAlerts === 'function') {
            renderAlerts();
        }
    }
}

function displayResults(totalEvaded, totalDetected) {
    // Update stats
    document.getElementById('attempts-count').textContent = simulationState.transactions.length;
    document.getElementById('detected-count').textContent = simulationState.transactions.filter(t => t.detected).length;
    document.getElementById('detection-rate').textContent = `${Math.round((totalDetected / totalEvaded) * 100)}%`;
    document.getElementById('amount-evaded').textContent = `$${totalEvaded.toLocaleString(undefined, {maximumFractionDigits: 2})}`;
    
    // Render chart
    renderSimulationChart();
    
    // Render transaction list
    renderTransactionList();
}

function renderSimulationChart() {
    const ctx = document.getElementById('simulation-chart');
    if (!ctx) return;
    
    // Destroy previous chart if exists
    if (simulationState.chart) {
        simulationState.chart.destroy();
    }
    
    // Group transactions by month
    const monthlyData = {};
    simulationState.transactions.forEach(t => {
        const monthYear = `${t.date.getFullYear()}-${t.date.getMonth()}`;
        if (!monthlyData[monthYear]) {
            monthlyData[monthYear] = {
                total: 0,
                detected: 0
            };
        }
        monthlyData[monthYear].total += t.amount;
        if (t.detected) {
            monthlyData[monthYear].detected += t.amount;
        }
    });
    
    // Prepare chart data
    const labels = Object.keys(monthlyData).sort().map(key => {
        const [year, month] = key.split('-');
        return new Date(year, month).toLocaleDateString(undefined, {month: 'short', year: 'numeric'});
    });
    
    const totalData = Object.keys(monthlyData).sort().map(key => monthlyData[key].total);
    const detectedData = Object.keys(monthlyData).sort().map(key => monthlyData[key].detected);
    
    simulationState.chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Total Evaded',
                    data: totalData,
                    backgroundColor: 'rgba(52, 152, 219, 0.7)'
                },
                {
                    label: 'Detected',
                    data: detectedData,
                    backgroundColor: 'rgba(46, 204, 113, 0.7)'
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'Amount ($)'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Month'
                    }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return `${context.dataset.label}: $${context.raw.toLocaleString()}`;
                        }
                    }
                }
            }
        }
    });
}

function renderTransactionList() {
    const container = document.getElementById('transaction-list');
    if (!container) return;
    
    if (simulationState.transactions.length === 0) {
        container.innerHTML = '<p>No transactions generated</p>';
        return;
    }
    
    // Sort by date (newest first)
    const sortedTransactions = [...simulationState.transactions].sort((a, b) => b.date - a.date);
    
    container.innerHTML = sortedTransactions.map(t => `
        <div class="transaction-item">
            <div>
                <strong>${formatDate(t.date)}</strong>
                <div class="transaction-method">${simulationState.selectedScenario} • $${t.amount.toLocaleString()}</div>
            </div>
            <div class="${t.detected ? 'transaction-detected' : 'transaction-undetected'}">
                ${t.detected ? `Detected (${t.detectionMethod})` : 'Not detected'}
            </div>
        </div>
    `).join('');
}

function formatDate(date) {
    return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
}

// Set up navigation between sections
function setupNavigation() {
    navLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();

            // Get target section
            const targetId = this.getAttribute('href');
            const targetSection = document.querySelector(targetId);

            if (!targetSection) return;

            // Update active nav link
            navLinks.forEach(navLink => navLink.classList.remove('active'));
            this.classList.add('active');

            // Hide all sections
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Show target section
            targetSection.classList.add('active');
        });
    });
}
    </script>
</body>
</html>